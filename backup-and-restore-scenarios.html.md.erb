---
title: Backup and Restore Scenarios and Test Considerations
owner: TKGI
---

This section describes backup and restore scenarios and considerations.

## Scenarios and Considerations

The following sencarios and considerations summarize the various aspects of backup and restore for TKGI.

Scenario 							| Tool(s) 		| Test Considerations 
------------------------------------|---------------|-----------------------------|
| Backup and restore vSpere SDDC 	| vCenter file backup | On restore, TKGI clusters with HA and DRS enabled should be availale. NOTE: Must Use 3rd party software for host data protection. 
| Backup and restore NSXT with app included in the backup | NSX-T Backup & Restore | For any app deployed before a backup was taken, there should be no loss of connectivity. 
| Backup and restore NSXT with app not included in the backup | NSX-T Backup & Restore | For any app deployed after a backup was taken, the pods must be redeployed after a restore, and the namespaces must be recreated. 
| Backup and restore NSXT with TKGI cluster created after the backup | NSX-T Backup & Restore | Take NSX-T backup, then create TKGI cluster. After NSX-T restore, the TKGI cluster is not reachable. You must delete and recreate cluster.
| Create or delete Kubernetes namespace when NSX-T is down | NSX-T Backup & Restore | For create, you need to recreate Namespace when NSX-T is restore. For delete, components are deleted when NSX-T is restored.
| Create or delete apps when NSX-T is down | NSX-T Backup & Restore | For create, Kubernetes pods will be stuck in in ContainerCreating state. If the namespace was created before, restarting pods brings the PODs to running state. If the app is still in ContainerCreating State, you must recreate the namespace and apps. Pods are successfully deleted when NSX-T is restored.
| Create or delete Kuberentes load balancer service when NSX-T is down | NSX-T Backup and Restore | On create, the load balance IP is pending; redeploy the service. On delete, the load balancer is deleted when NSX-T is restored. 
| Create or delete a cluster when NSX-T is down | NSX-T Backup and Restore | Unable to create or delete a cluster if NSX-T is down.
| Backup and restore Ops Manager | Ops Manager configuration export/import | Power off Ops Manager. Deploy new Ops Manager instance, load exported configuration. BOSH and TKGI tiles should be configured.
| Backup and restore TKGI nodes | BBR | Power off  TKGI nodes. Restore BOSH from backup. Restore TKGI from backup. TKGI nodes are recreated. NOTE: Existing nodes are NOT deleted.
| Backup restore TKGI cluster | BBR | Take backup. Delete TKGI cluster VMs (control plane and worker nodes). Delete disk and references. Restore cluster using BBR. Delete worker nodes from kubectl. Restart kubelet. Observations: If app is deployed before cluster backup, LB IP of app changes. Test 6 for using static LB IP. If app is deployed after backup, the app goes away and NSX objects for app are deleted automatically.
| Backup and restore stateless app 		| Velero, Restic 	| Install Velero/Restic on cluster. Enable privileged mode. App is restored. 
| Backup and restore stateful app 		| Velero, Restic 	| Install Velero/Restic on cluster. Enable privileged mode. App is restored.
| Backup and restore statelfulset app 	| Velero, Restic 	| Install Velero/Restic on cluster. Enable privileged mode. App is restored.
| Backup and restore whole cluster 		| Velero, Restic 	| Install Velero/Restic on cluster. Enable privileged mode. App is restored.
| Backup and restore app with fixed IP 	| Velero, Restic 	| Install Velero/Restic on cluster. Enable privileged mode. App is restored.
| Backup and restore statful apps with CSI 	| Velero, Restic 	| Install Velero/Restic on cluster. Enable privileged mode. App is restored.
