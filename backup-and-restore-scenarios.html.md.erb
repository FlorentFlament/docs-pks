---
title: Overview of Backing Up and Restoring TKGI
owner: TKGI
---

This section provides an overview of the backup and restore process for all TKGI components, and provides high-level considerations for each layer.

##<a id="layers-tools"></a> Layers and Tools

TKGI backup and restore comprises various layers and tools. The table summarizes theses layers and tools from the top-down, that is, workload to infrastructure. Refer to the individual sections for details on performing backup and restore for that layer, as well as additional details on common scenarios.

Layer 							| Tool(s) 		    | Comments 
--------------------------------|-------------------|-----------------------------|
| [Backup and Restore Kubernetes Workloads](./backup-and-restore-work.html) | Velero, Restic | Use Velero for for stateless and Velero with Restic for stateful applications. Load balancer and ingress services depend on NSX-T backup. See <a href="./velero-scenarios.html">Velero Backup and Restore Scenarios</a> for details. 
| [Backup and Restore TKGI Clusters](./backup-and-restore-tkgi.html) | BOSH Backup and Restore (BBR) | Use BBR to back up and restore <%= vars.k8s_runtime_abbr %> clusters, which includes the control plane and worker nodes; See <a href="./backup-and-restore-tkgi.html">TKGI Cluster Backup and Restore Scenarios</a> for details.
| [Backup and Restore TKGI Management Plane](./backup-and-restore-tkgi-mgmt.html) | Ops Manager, BBR | Export Ops Manager configuration and import to new Ops Manager instance. Use BBR to backup and restore the TKGI Management Plane VMs: BOSH, TKGI API, TKGI DB. See <a href="./backup-and-restore-tkgi-mgmt.html">TKGI Management Plane Backup and Restore Scenarios</a> for details.
| [Backup and Restore TKGI SDDC](./backup-and-restore-sddc.html) | NSX-T Manager | Use the NSX Manager UI or CLI to backup the NSX Manager DB. See <a href="./backup-and-restore-sddc.html">TKGI Cluster Backup and Restore Scenarios</a> for details.

##<a id="considerations"></a> Considerations

When planning your backup and restore policy and process for TKGI, keep in mind the following considerations.

### Back Up Regularly and Frequently 

Key resources should be backed up on a regular and frequent schedule, such as every 24-hours (nightly).

### Back Up Critical Components

The most important components to back up are stateful applications, cluster configurations, and NSX-T objects.

- When you deploy an application, take a backup using Velero and Restic.
- When you create a TKGI cluster, take a backup using BBR and NSX-T.
- When you deploy TKGI or update the TKGI or BOSH Director tiles, take a backup of Ops Manager.
- When you create one of the following NSX-T objects, take a backup using NSX-T.
  - Load balancer 
  - Namespace
  - Logical switch (created when a TKGI cluster is provisioned)
  - Ingress
  - Network Policy

### Restore What Breaks

The general approach is to restore what breaks. For example, if NSX-T crashes, you only need to restore NSX-T. If Ops Manager breaks, restore Ops Manager.

The exception is a Kubernetes cluster. If the cluster breaks, you need to restore the cluster using BBR and the applications using Velero. On the NSX-T side, you need to create a new namespace for the restored cluster. Using kubectl, delete the old namespace. This will force the creation of the NSX-T objects in the namespace. Refer to the scenarios for the TKGI cluster backup and restore for more details.

### Understand What Is Restored at Each Layer

Because there are several layers and tools involved in the backup and restore of TKGI, it can be confusing what is being backed up and restored within each layer.

Velero is used for backing up and restoring Kubernetes workloads. Restic is used with Velero for backup and restore of stateful workloads. Use Velero restore if something breaks in a workload application, and you need to restore it.

BBR is used to backup and restore Kubernetes clusters provisioned by TKGI. This includes the cluster nodes and etcd database. BBR may also restore stateless applications, depending on when the backup of the cluster was taken, but you shouldn't rely on it for such purposes. Use Velero for workload backup and restore.

For BBR to work restoring a cluster, the NSX-T objects need to be in the NSX-T database. BBR will only work if the objects are in NSX-T. BBR recreates the VM, not the logical switch. You need the logical switch to be present for each Kubernetes cluster.

If NSX-T crashes, you only need to restore NSX-T. Applications will continue to run, but you can't add anything.

### Develop a Plan and Test It

This documentation provides guidelines for developing a robust backup and restore plan for TKGI. You must test the backup and restore of each layer of your TKGI foundation to ensure that the components and workloads are properly backed up and restored. 



