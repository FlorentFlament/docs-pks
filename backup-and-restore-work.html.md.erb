---
title: Backing Up and Restoring Kubernetes Workloads Using Valero and Restic
owner: TKGI
---

This section describes how to back up and restore Kubernetes workloads deployed to TKGI clusters using Valero and Restic.

## <a id="valero-about"></a>About Valero and Restic

[Valero](https://velero.io/) is an open-source project that provides backup and recovery of Kubernetes workloads. Using Valero provides a consistent solution for backup and recovery across the Tanzu portfolio of products.

[Restic](https://github.com/restic/restic) is an open-source program that is used as a plugin for Velero will be leveraged to perform backup and restore of stateful apps.

Velero is the only open source product to provide backup and recovery capabilities of Kubernetes workloads.  Restic is used as a [companion tool](https://velero.io/docs/v1.4/restic/) with Valero to provide platform independent volume snapshots. Together Vaero and Restic support backup and recovery all types of Kubernetes workloads deployed to Tanzu clusters.

##<a id="prerequisites"></a> Prerequisites

This section lists the prerequisites for using Valero for backup and recovery.

###<a id="valero-cluster-req"></a> Cluster Configuration

A Velero pod and a Restic pod are installed on the Kubernetes cluster. To use Valero and Restic for Kubernetes workload backup and recovery with TKGI, you must configure each target cluster as follows:

1. Enable the `Allow Privileged` option in your plan configuration so that Restic is able to mount the hostpath.
1. Change the hostPath from `/var/lib/kubelet/pods` to `/var/vcap/data/kubelet/pods`.

###<a id="valero-objstore-req"></a> Object Store VM

You need to provide an object store for Valero backups. Valero supports a number of [object store providers](https://velero.io/docs/v1.4/supported-providers/). Minio is an Amazon S3 compatible object store that is easy to install and use. This documentation uses the Minio server installed on a Linux VM as a backup destination.

###<a id="valero-client-req"></a> Valero CLI Client

To perform Valero backup and recovery, you install the Velero CLI on a client VM. This can be the TKGI client VM or an administrator laptop.

###<a id="valero-airgap-req"></a>Air-Gapped Environment

The instructions assume that the cluster environment has internet access, including the client where the Velero CLI is installed as well as the Kuberentes  cluster. In case the environment has no internet access, follow the procedure listed in this doc: https://velero.io/docs/v1.4/on-premises/#air-gapped-deployments

###<a id="valero-version-req"></a> Valero Version Requirement

This documentation is tested with [Velero v1.4.2](https://github.com/vmware-tanzu/velero/releases/tag/v1.4.2).

##<a id="next-topic"></a> Next Topic


