---
title: Upgrade Order for Tanzu Kubernetes Grid Integrated Edition Environments on vSphere
owner: TKGI
---

<style>

.upgrade-table li {
    margin: 0 0 .6em;
}

</style>


This topic provides upgrade scenarios for
<%= vars.product_full %> environments that are upgraded from
v1.7 to v1.8 on vSphere.

## <a id="overview"></a>Overview

To perform an upgrade following one of the
scenarios below, you must upgrade your <%= vars.product_short %> environment
in the order listed under the scenario you want to follow.

* If your environment is on vSphere with NSX-T networking,
see [<%= vars.k8s_runtime_abbr %> on vSphere with NSX-T Networking](#nsxt) below.
* If your environment is on vSphere with Flannel networking,
see
[<%= vars.k8s_runtime_abbr %> on vSphere with Flannel Networking](#flannel)
below.

## <a id="nsxt"></a><%= vars.k8s_runtime_abbr %> on vSphere with NSX-T Networking

When upgrading a <%= vars.product_short %> (<%= vars.k8s_runtime_abbr %>)
environment on vSphere with NSX-T networking, you can choose to upgrade any
of the following:

* <%= vars.k8s_runtime_abbr %> only,
including Ops Manager and Kubernetes clusters
* <%= vars.k8s_runtime_abbr %>, including Ops Manager and Kubernetes clusters,
and NSX-T
* <%= vars.k8s_runtime_abbr %>, including Ops Manager and Kubernetes clusters,
NSX-T, and vSphere

For more information, see below:

<table class="nice upgrade-table">
<col width="20%">
<col width="40%">
<col width="40%">
    <th>To upgrade these components...</th>
    <th>Use this order...</th>
    <th>For more information, see...</th>
    <tr>
        <td><%= vars.k8s_runtime_abbr %></td>
        <td>
            <ol>
              <li>Upgrade Ops Manager if necessary.</li>
              <li>Upgrade <%= vars.k8s_runtime_abbr %>.</li>
              <li>Upgrade Kubernetes clusters.</li>
            </ol>
        </td>
        <td><a href="#tkgi-only">Upgrading to <%= vars.k8s_runtime_abbr %> v1.8</a></td>
    </tr>
    <tr>
        <td><%= vars.k8s_runtime_abbr %> and NSX-T</td>
        <td>
            <ol>
              <li>Upgrade Ops Manager if necessary.</li>
              <li>Upgrade <%= vars.k8s_runtime_abbr %>.</li>
              <li>Upgrade Kubernetes clusters.</li>
              <li>Upgrade NSX-T.</li>
            </ol>
        </td>
        <td><a href="#tkgi-nsxt">Upgrading to <%= vars.k8s_runtime_abbr %> v1.8 and NSX-T v3.0</a></td>
    </tr>
    <tr>
        <td><%= vars.k8s_runtime_abbr %>, NSX-T, and vSphere</td>
        <td>
            <ol>
              <li>Upgrade Ops Manager if necessary.</li>
              <li>Upgrade <%= vars.k8s_runtime_abbr %>.</li>
              <li>Upgrade Kubernetes clusters.</li>
              <li>Upgrade NSX-T.</li>
              <li>Upgrade vSphere.</li>
            </ol>
        </td>
        <td><a href="#tkgi-nsxt-vsphere">Upgrading to <%= vars.k8s_runtime_abbr %> v1.8, NSX-T v3.0, and vSphere v7.0</a></td>
    </tr>
</table>

  <p class="note"><strong>Note:</strong> VMware does not recommend upgrading
  NSX-T from v2.5 to v3.0 until NSX-T v3.0.1 becomes available.</p>

For a list of NSX-T and vSphere versions compatible with
<%= vars.product_short %> v1.8, see:

* [Product Snapshot](release-notes.html) in _Release Notes_
* [VMware Product Interoperability Matrices](https://www.vmware.com/resources/compatibility/sim/interop_matrix.php#interop&356=&175=&1=)

### <a id="tkgi-only"></a>Scenario 1: Upgrading to <%= vars.k8s_runtime_abbr %> v1.8

In this upgrade scenario, you upgrade <%= vars.product_short %>
from v1.7 to v1.8 and do not upgrade your NSX-T or vSphere infrastructure.

The upgrade scenario includes the following steps:

1. Upgrade Ops Manager to v2.9.1 or later, v2.8.2 or later, or v2.7.15 or later.
These are the recommended Ops Manager versions for <%= vars.product_short %> v1.8.0.
To verify Ops Manager compatibility with other v1.8 versions, see
[<%= vars.product_network %>](https://network.pivotal.io/products/pivotal-container-service/).
1. Upgrade <%= vars.product_short %> from v1.7 to v1.8.
1. Upgrade all Kubernetes clusters to
<%= vars.product_short %> v1.8.
This upgrades the NCP version of your clusters to 3.0.1.

See the table below for version information and instructions for this
upgrade scenario:

<table class="nice">
<col width="15%">
<col width="20%">
<col width="20%">
<col width="45%">
    <th>Component</th>
    <th>Pre-upgrade version</th>
    <th>Post-upgrade version</th>
    <th>Instructions</th>
    <tr>
        <td><%= vars.k8s_runtime_abbr %></td>
        <td><strong>1.7</strong></td>
        <td><strong>1.8</strong></td>
        <td>See <a href="upgrade-nsxt.html">Upgrading Tanzu Kubernetes Grid Integrated Edition (NSX-T Networking)</a>.</td>
    </tr>
    <tr>
        <td>Ops Manager</td>
        <td>2.7, 2.8, or 2.9</td>
        <td>2.7, 2.8, or 2.9</td>
        <td><em>n/a</em></td>
    </tr>
    <tr>
        <td>NSX-T<sup>&#42;</sup></td>
        <td>2.5.0 or 2.5.1</td>
        <td>2.5.0 or 2.5.1</td>
        <td><em>n/a</em></td>
    </tr>
    <tr>
        <td>NCP</td>
        <td><strong>2.5.1</strong></td>
        <td><strong>3.0.1</strong></td>
        <td><em>n/a</em></td>
    </tr>
    <tr>
        <td>vSphere</td>
        <td>6.5 or 6.7</td>
        <td>6.5 or 6.7</td>
        <td><em>n/a</em></td>
    </tr>
</table>

<%= partial 'note-about-upgrade' %>

### <a id="tkgi-nsxt"></a>Scenario 2: Upgrading to <%= vars.k8s_runtime_abbr %> v1.8 and NSX-T v3.0

In this upgrade scenario, you upgrade <%= vars.product_short %> from v1.7 to
v1.8 and NSX-T from v2.5.0 or v2.5.1 to v3.0.

The upgrade scenario includes the following steps:

1. Upgrade Ops Manager to v2.9.1 or later.
These are the recommended Ops Manager versions
for <%= vars.product_short %> v1.8.0.
To verify Ops Manager compatibility with other v1.8 versions, see
[<%= vars.product_network %>](https://network.pivotal.io/products/pivotal-container-service/).
1. Upgrade <%= vars.product_short %> from v1.7 to v1.8.
1. Upgrade all Kubernetes clusters to
<%= vars.product_short %> v1.8.
This upgrades the NCP version of your clusters to 3.0.1.
1. Upgrade NSX-T from v2.5.0 or v2.5.1 to v3.0.

See the table below for version information and instructions for this
upgrade scenario:

<table class="nice">
<col width="15%">
<col width="20%">
<col width="20%">
<col width="45%">
    <th>Component</th>
    <th>Pre-upgrade version</th>
    <th>Post-upgrade version</th>
    <th>Instructions</th>
    <tr>
        <td><%= vars.k8s_runtime_abbr %></td>
        <td><strong>1.7</strong></td>
        <td><strong>1.8</strong></td>
        <td>See <a href="upgrade-nsxt.html">Upgrading Tanzu Kubernetes Grid Integrated Edition (NSX-T Networking)</a>.</td>
    </tr>
    <tr>
        <td>Ops Manager</td>
        <td><strong>2.7, 2.8,</strong> or <strong>2.9</strong></td>
        <td><strong>2.9</strong></td>
        <td><em>n/a</em></td>
    </tr>
    <tr>
        <td>NSX-T<sup>&#42;</sup></td>
        <td><strong>2.5.0</strong> or <strong>2.5.1</strong></td>
        <td><strong>3.0</strong></td>
        <td>See <a href="upgrade-nsxt.html#upgrade-nsxt">Upgrade NSX-T Data Center v2.5 to v3.0</a>
        in <em>Upgrading Tanzu Kubernetes Grid Integrated Edition (NSX-T Networking)</em>.</td>
    </tr>
    <tr>
        <td>NCP</td>
        <td><strong>2.5.1</strong></td>
        <td><strong>3.0.1</strong></td>
        <td><em>n/a</em></td>
    </tr>
    <tr>
        <td>vSphere</td>
        <td>6.5 or 6.7</td>
        <td>6.5 or 6.7</td>
        <td><em>n/a</em></td>
    </tr>
</table>

<%= partial 'note-about-upgrade' %>

### <a id="tkgi-nsxt-vsphere"></a>Scenario 3: Upgrading to <%= vars.k8s_runtime_abbr %> v1.8, NSX-T v3.0, and vSphere v7.0

In this upgrade scenario, you upgrade:

* <%= vars.product_short %> from v1.7 to v1.8
* NSX-T from v2.5.0 or v2.5.1 to v3.0
* vSphere from v6.5 or v6.7 to v7.0

The upgrade scenario includes the following steps:

1. Upgrade Ops Manager to v2.9.1 or later.
These are the recommended Ops Manager versions for <%= vars.product_short %> v1.8.0.
To verify Ops Manager compatibility with other v1.8 versions, see
[<%= vars.product_network %>](https://network.pivotal.io/products/pivotal-container-service/).
1. Upgrade <%= vars.product_short %> from v1.7 to v1.8.
1. Upgrade all Kubernetes clusters to
<%= vars.product_short %> v1.8.
This upgrades the NCP version of your clusters to 3.0.1.
1. Upgrade NSX-T from v2.5.0 or v2.5.1 to v3.0.
1. Upgrade vSphere from v6.5 or v6.7 to v7.0.

See the table below for version information and instructions for this
upgrade scenario:

<table class="nice upgrade-table">
<col width="15%">
<col width="18%">
<col width="18%">
<col width="49%">
    <th>Component</th>
    <th>Pre-upgrade version</th>
    <th>Post-upgrade version</th>
    <th>Instructions</th>
    <tr>
        <td><%= vars.k8s_runtime_abbr %></td>
        <td><strong>1.7</strong></td>
        <td><strong>1.8</strong></td>
        <td>See <a href="upgrade-nsxt.html">Upgrading Tanzu Kubernetes Grid Integrated Edition (NSX-T Networking)</a>.</td>
    </tr>
    <tr>
        <td>Ops Manager</td>
        <td><strong>2.7, 2.8,</strong> or <strong>2.9</strong></td>
        <td><strong>2.9</strong></td>
        <td><em>n/a</em></td>
    </tr>
    <tr>
        <td>NSX-T<sup>&#42;</sup></td>
        <td><strong>2.5.0</strong> or <strong>2.5.1</strong></td>
        <td><strong>3.0</strong></td>
        <td>See <a href="upgrade-nsxt.html#upgrade-nsxt">Upgrade NSX-T Data Center v2.5 to v3.0</a>
        in <em>Upgrading Tanzu Kubernetes Grid Integrated Edition (NSX-T Networking)</em>.</td>
    </tr>
    <tr>
        <td>NCP</td>
        <td><strong>2.5.1</strong></td>
        <td><strong>3.0.1</strong></td>
        <td><em>n/a</em></td>
    </tr>
    <tr>
        <td>vSphere</td>
        <td><strong>6.5</strong> or <strong>6.7</strong></td>
        <td><strong>7.0</strong></td>
        <td><p>See the vSphere documentation:</p>
          <ol>
            <li><a href="https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vcenter.upgrade.doc/GUID-30485437-B107-42EC-A0A8-A03334CFC825.html">Upgrading the vCenter Server Appliance</a></li>
            <li><a href="https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.esxi.upgrade.doc/GUID-122035F6-8433-463E-A0F7-B4FC71A05B04.html">Upgrading ESXi Hosts</a></li>
          </ol>

          Also, see <a href="https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vcenter.upgrade.doc/GUID-7AFB6672-0B0B-4902-B254-EE6AE81993B2.html">Overview of the vSphere Upgrade Process</a>.</td>
    </tr>
</table>

<%= partial 'note-about-upgrade' %>

## <a id="flannel"></a><%= vars.k8s_runtime_abbr %> on vSphere with Flannel Networking

When upgrading a <%= vars.product_short %> environment on vSphere with Flannel
networking, you can choose to upgrade any of the following:

* <%= vars.k8s_runtime_abbr %> only,
including Ops Manager and Kubernetes clusters
* <%= vars.k8s_runtime_abbr %>, including Ops Manager and Kubernetes clusters,
and vSphere

For more information, see below:

<table class="nice upgrade-table">
<col width="20%">
<col width="40%">
<col width="40%">
    <th>To upgrade these components...</th>
    <th>Use this order...</th>
    <th>For more information, see...</th>
    <tr>
        <td><%= vars.k8s_runtime_abbr %></td>
        <td>
            <ol>
              <li>Upgrade Ops Manager if necessary.</li>
              <li>Upgrade <%= vars.k8s_runtime_abbr %>.</li>
              <li>Upgrade Kubernetes clusters.</li>
            </ol>
        </td>
        <td><a href="#tkgi-only-flannel">Upgrading to <%= vars.k8s_runtime_abbr %> v1.8</a></td>
    </tr>
    <tr>
        <td><%= vars.k8s_runtime_abbr %> and vSphere</td>
        <td>
            <ol>
              <li>Upgrade Ops Manager if necessary.</li>
              <li>Upgrade <%= vars.k8s_runtime_abbr %>.</li>
              <li>Upgrade Kubernetes clusters.</li>
              <li>Upgrade vSphere.</li>
            </ol>
        </td>
        <td><a href="#tkgi-vsphere">Upgrading to <%= vars.k8s_runtime_abbr %> v1.8 and vSphere v7.0</a></td>
    </tr>
</table>

For a list of vSphere versions compatible with
<%= vars.product_short %> v1.8, see [VMware Product Interoperability Matrices](https://www.vmware.com/resources/compatibility/sim/interop_matrix.php#interop&356=&175=&1=).

### <a id="tkgi-only-flannel"></a>Scenario 1: Upgrading to <%= vars.k8s_runtime_abbr %> v1.8

In this upgrade scenario, you upgrade <%= vars.product_short %>
from v1.7 to v1.8 and do not upgrade your vSphere infrastructure.

The upgrade scenario includes the following steps:

1. Upgrade Ops Manager to v2.9.1 or later, v2.8.2 or later, or v2.7.15 or later.
These are the recommended Ops Manager versions for <%= vars.product_short %> v1.8.0.
To verify Ops Manager compatibility with other v1.8 versions, see
[<%= vars.product_network %>](https://network.pivotal.io/products/pivotal-container-service/).
1. Upgrade <%= vars.product_short %> from v1.7 to v1.8.
1. Upgrade all Kubernetes clusters to
<%= vars.product_short %> v1.8.

See the table below for version information and instructions for this
upgrade scenario:

<table class="nice">
<col width="15%">
<col width="20%">
<col width="20%">
<col width="45%">
    <th>Component</th>
    <th>Pre-upgrade version</th>
    <th>Post-upgrade version</th>
    <th>Instructions</th>
    <tr>
        <td><%= vars.k8s_runtime_abbr %></td>
        <td><strong>1.7</strong></td>
        <td><strong>1.8</strong></td>
        <td>See <a href="upgrade.html">Upgrading Enterprise PKS (Flannel Networking)</a>.</td>
    </tr>
    <tr>
        <td>Ops Manager</td>
        <td>2.7, 2.8, or 2.9</td>
        <td>2.7, 2.8, or 2.9</td>
        <td><em>n/a</em></td>
    </tr>
    <tr>
        <td>vSphere</td>
        <td>6.5 or 6.7</td>
        <td>6.5 or 6.7</td>
        <td><em>n/a</em></td>
    </tr>
</table>

### <a id="tkgi-vsphere"></a>Scenario 2: Upgrading to <%= vars.k8s_runtime_abbr %> v1.8 and vSphere v7.0

In this upgrade scenario, you upgrade <%= vars.product_short %> from v1.7 to
v1.8 and vSphere from v6.5 or v6.7 to v7.0.

The upgrade scenario includes the following steps:

1. Upgrade Ops Manager to v2.9.1 or later.
These are the recommended Ops Manager versions for <%= vars.product_short %> v1.8.0.
To verify Ops Manager compatibility with other v1.8 versions, see
[<%= vars.product_network %>](https://network.pivotal.io/products/pivotal-container-service/).
1. Upgrade <%= vars.product_short %> from v1.7 to v1.8.
1. Upgrade all Kubernetes clusters to
<%= vars.product_short %> v1.8.
1. Upgrade vSphere from v6.5 or v6.7 to v7.0.

See the table below for version information and instructions for this
upgrade scenario:

<table class="nice upgrade-table">
<col width="15%">
<col width="18%">
<col width="18%">
<col width="49%">
    <th>Component</th>
    <th>Pre-upgrade version</th>
    <th>Post-upgrade version</th>
    <th>Instructions</th>
    <tr>
        <td><%= vars.k8s_runtime_abbr %></td>
        <td><strong>1.7</strong></td>
        <td><strong>1.8</strong></td>
        <td>See <a href="upgrade.html">Upgrading Enterprise PKS (Flannel Networking)</a>.</td>
    </tr>
    <tr>
        <td>Ops Manager</td>
        <td><strong>2.7, 2.8,</strong> or <strong>2.9</strong></td>
        <td><strong>2.9</strong></td>
        <td><em>n/a</em></td>
    </tr>
    <tr>
        <td>vSphere</td>
        <td><strong>6.5</strong> or <strong>6.7</strong></td>
        <td><strong>7.0</strong></td>
        <td><p>See the vSphere documentation:</p>
          <ol>
            <li><a href="https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vcenter.upgrade.doc/GUID-30485437-B107-42EC-A0A8-A03334CFC825.html">Upgrading the vCenter Server Appliance</a></li>
            <li><a href="https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.esxi.upgrade.doc/GUID-122035F6-8433-463E-A0F7-B4FC71A05B04.html">Upgrading ESXi Hosts</a></li>
          </ol>

          Also, see <a href="https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vcenter.upgrade.doc/GUID-7AFB6672-0B0B-4902-B254-EE6AE81993B2.html">Overview of the vSphere Upgrade Process</a>.</td>
    </tr>
</table>
