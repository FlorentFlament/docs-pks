---
title: vSphere with NSX-T Cluster Objects
owner: PKS
---

<strong><%= modified_date %></strong>

This topic lists the PKS objects created when you create Kubernetes cluster on vSphere with NSX-T integration.

##<a id="vsphere-version"></a> vSphere Virtual Machines

When a new Kubernetes cluster is created, the following VMs are created by default:

<table>
  <tr>
    <th>Object Amount</th>
    <th>Object Description</th>
  </tr>
  <tr>
    <td>1 or 3</td>
    <td>Kubernetes master nodes (number depends on the plan chosen)</td>
  </tr>
  <tr>
    <td>1 or more</td>
    <td>Kubernetes worker nodes (number depends on the plan chosen)</td>
  </tr>
</table>

##<a id="vsphere-version"></a> NSX-T Objects

When a new Kubernetes Cluster is created, the following NSX-T objects are created by default.

### NSX-T Logical Switch

<table>
  <tr>
    <th>Object Amount</th>
    <th>Object Description</th>
  </tr>
  <tr>
    <td>1</td>
    <td>Logical switch for Kubernetes master and worker nodes</td>
  </tr>
  <tr>
    <td>1</td>
    <td>Logical switch for each Kubernetes namespace (`default`, `kube-public`, `kube-system`, `pks-infrastructure`)</td>
  </tr>
  <tr>
    <td>1</td>
    <td>Logical switch for the NSX-T load balancer associated with the Kubernetes Cluster</td>
  </tr>
</table>

- 1 logical switch for Kubernetes master and worker nodes
- 1 logical switch for each Kubernetes namespace (`default`, `kube-public`, `kube-system`, `pks-infrastructure`)
- 1 logical switch for the NSX-T load balancer associated with the Kubernetes Cluster

### NSX-T Tier-1 Router

<table>
  <tr>
    <th>Object Amount</th>
    <th>Object Description</th>
  </tr>
  <tr>
    <td>1</td>
    <td>Tier-1 router for Kubernetes master and worker nodes (called "cluster-router")</td>
  </tr>
  <tr>
    <td>1</td>
    <td>Tier-1 router for each Kubernetes namespace (`default`, `kube-public`, `kube-system`, `pks-infrastructure`)</td>
  </tr>
  <tr>
    <td>1</td>
    <td>Tier-1 router for the NSX-T load balancer associated with the Kubernetes Cluster</td>
  </tr>
</table>

- 1 Tier-1 router for Kubernetes master and worker nodes (called "cluster-router")
- 1 Tier-1 router for each Kubernetes namespace (`default`, `kube-public`, `kube-system`, `pks-infrastructure`)
- 1 Tier-1 router for the NSX-T load balancer associated with the Kubernetes Cluster

### NSX-T Load Balancer

For each Kubernetes cluster created, a single NSX-T load balancer small instance is deployed that contains the following objects:

<table>
  <tr>
    <th>Object Amount</th>
    <th>Object Description</th>
  </tr>
  <tr>
    <td>1</td>
    <td>Virtual Server (VS) to access Kubernetes control plane API (with port 8443)</td>
  </tr>
  <tr>
    <td>1</td>
    <td>Server Pool containing the 3 Kubernetes master nodes.</td>
  </tr>
  <tr>
    <td>1</td>
    <td>Virtual Server (VS) for Ingress Controller (HTTP)</td>
  </tr>
  <tr>
    <td>1</td>
    <td>Virtual Server for Ingress Controller (HTTPS)</td>
  </tr>
</table>

The IP address allocated to each VS is derived from the PKS Floating IP Pool. The VS for the HTTP Ingress Controller and the VS for the HTTPS Ingress Controller use the same IP address.

### NSX-T DDI/IPAM

<table>
  <tr>
    <th>Object Amount</th>
    <th>Object Description</th>
  </tr>
  <tr>
    <td>1</td>
    <td>A /24 subnet from the **Nodes IP Block** will be extracted and allocated for the Kubernetes master and worker nodes</td>
  </tr>
  <tr>
    <td>1</td>
    <td>A /24 subnet from the **Pods IP Block** will be extracted and allocated for each Kubernetes namespace (`default`, `kube-public`, `kube-system`, `pks-infrastructure`)</td>
  </tr>
</table>

### NSX-T Tier-0 router

<table>
  <tr>
    <th>Object Amount</th>
    <th>Object Description</th>
  </tr>
  <tr>
    <td>1</td>
    <td>SNAT rule created for each Kubernetes namespace (`default`, `kube-public`, `kube-system`, `pks-infrastructure`) using 1 IP from Floating IP Pool as translated IP addres</td>
  </tr>
  <tr>
    <td>1</td>
    <td>If NAT toplogy is used, SNAT rule is created for each Kubernetes cluster (in case NAT topology is used) using 1 IP from Floating IP Pool as translated IP address. The Kubernetes cluster subnet is derived from the **Nodes IP Block** using a /24 netmask</td>
  </tr>
</table>

### NSX-T Distributed Firewall (DFW)

<table>
  <tr>
    <th>Object Amount</th>
    <th>Object Description</th>
  </tr>
  <tr>
    <td>1</td>
    <td>DFW rule for kubernetes-dashboard: Source=Kubernetes worker node (hosting the dashboard Pod); Destination=Dashboard Pod IP; Port: TCP/8443; Action: allow</td>
  </tr>
  <tr>
    <td>1</td>
    <td>DFW rule for kube-dns: Source=Kubernetes worker node (hosting the DNS Pod); Destination=DNS Pod IP; Port: TCP/8081 and TCP/10054; Action: allow</td>
  </tr>
</table>


